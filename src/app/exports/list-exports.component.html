<div class="container main-container" >
    <app-progress-spinner class="example-margin" [color]="color" [mode]="mode" [value]="value" [backdropEnabled]="true" [positionGloballyCenter]="true"
        [displayProgressSpinner]="displayProgressSpinner">
   </app-progress-spinner>   
    <!--Card-->
    <mat-card>
        <ng-template ngbModalContainer></ng-template>
        <mat-card-content>
            <div class="container Custom-table-width">                        
                <div class="example-container mat-elevation-z8">
                    
                    <mat-table #table [dataSource]="dataSource" multiTemplateDataRows>
                    
                        <!-- Checkbox Column -->
                        <ng-container matColumnDef="select">
                            <mat-header-cell *matHeaderCellDef>
                                <mat-checkbox (change)="$event ? masterToggle() : null"
                                                [checked]="selection.hasValue() && isAllSelected()"
                                                [indeterminate]="selection.hasValue() && !isAllSelected()">
                                </mat-checkbox>
                            </mat-header-cell>
                            <mat-cell *matCellDef="let element">
                                <mat-checkbox (click)="$event.stopPropagation()"
                                                (change)="$event ? selection.toggle(element) : null"
                                                [checked]="selection.isSelected(element)">
                                </mat-checkbox>
                            </mat-cell>
                        </ng-container>
        
                        <ng-container matColumnDef="tableName">
                            <mat-header-cell *matHeaderCellDef> Table </mat-header-cell>
                            <mat-cell fxFlex="500" *matCellDef="let element"> {{element.tableName}} </mat-cell>
                        </ng-container>
                                                    
                        <ng-container matColumnDef="rowCount">
                            <mat-header-cell *matHeaderCellDef> Row Count </mat-header-cell>
                            <mat-cell fxFlex="500" *matCellDef="let element"> {{element.rowCount}} </mat-cell>
                        </ng-container>
                                       
                        <ng-container matColumnDef="expandedDetail">
                            <mat-cell *matCellDef="let detail"> 
                                <mat-form-field class="expanded-field" *ngIf="showRange(detail, 'numberRange')">
                                    <input matInput placeholder="Start Member #" [value]="detail.detailRow.startMemberNo" [(ngModel)]="detail.detailRow.startMemberNo">
                                </mat-form-field>
                                <mat-form-field class="expanded-field" *ngIf="showRange(detail, 'numberRange')">
                                    <input matInput placeholder="End Member #" [value]="detail.detailRow.endMemberNo" [(ngModel)]="detail.detailRow.endMemberNo">
                                </mat-form-field>
                                <mat-form-field class="expanded-field" *ngIf="showRange(detail, 'dateRange')">
                                    <input matInput [matDatepicker]="startPicker" placeholder="Start Date"  name="startDate" [(ngModel)]="detail.detailRow.startDate">
                                    <mat-datepicker-toggle matSuffix [for]="startPicker" tabindex=-1></mat-datepicker-toggle>
                                    <mat-datepicker #startPicker></mat-datepicker>
                                </mat-form-field>
                                <mat-form-field class="expanded-field" *ngIf="showRange(detail, 'dateRange')">
                                    <input matInput [matDatepicker]="endPicker" placeholder="End Date"  name="endDate" [(ngModel)]="detail.detailRow.endDate">
                                    <mat-datepicker-toggle matSuffix [for]="endPicker" tabindex=-1></mat-datepicker-toggle>
                                    <mat-datepicker #endPicker></mat-datepicker>
                                </mat-form-field>
                            </mat-cell>
                        </ng-container>
                      
                        <mat-header-row *matHeaderRowDef="displayedColumns"></mat-header-row>
                        <mat-row *matRowDef="let row; columns: displayedColumns;" 
                            matRipple 
                            class="element-row" 
                            [class.expanded]="expandedElement == row?.tableName"
                            (mouseover)="expandedElement = row"
                            (click)="selection.toggle(row)">
                        </mat-row>
                        <mat-row *matRowDef="let row; columns: ['expandedDetail']; when: isExpansionDetailRow"
                            [@detailExpand]="row?.tableName == expandedElement?.tableName ? 'expanded' : 'collapsed'"
                            style="overflow: hidden"> 
                        </mat-row>
                    </mat-table>

                    <div class="container">
                        <div class="row">
                            <div class="col-md-3">
                                <button mat-button style="margin-top:8px" (click)="onDownloadData()" ngbTooltip="Download file(s)">
                                        <i class="material-icons">file_download</i>
                                </button>
                            </div>
                            <div class="col-md-9">
                                <mat-paginator #paginator
                                    [showFirstLastButtons]="true"
                                    [length]="elementData.length" 
                                    [pageSize]="10"
                                    [pageSizeOptions]="[5, 10, 20]">
                                </mat-paginator>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </mat-card-content>
    </mat-card>
</div>
